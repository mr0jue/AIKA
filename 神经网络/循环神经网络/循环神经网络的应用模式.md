#循环神经网络 可以应用到很多不同类型的机器学习任务。根据这些任务的特点可以分为以下几种模式：序列到类别模式、同步的序列到序列模式、异步的序列到序列模式。

## 序列到类别模式
#序列到类别模式 主要用于序列数据的分类问题：输入为序列，输出为类别。比如在 #文本分类 中，输入数据为单词的序列，输出为该文本的类别。

假设一个样本 ${\mathbf{x}_{1: T}=\left(\mathbf{x}_{1}, \cdots, \mathbf{x}_{T}\right)}$ 为一个长度为 ${T}$ 的序列, 输出为一个类别 ${y \in\{1, \cdots, C\}}$ 。我们可以将样本 ${\mathbf{x}}$ 按不同时刻输入到循环神经网络中, 并得到不同时刻的隐藏状态 ${\mathbf{h}_{1}, \cdots, \mathbf{h}_{T}}$ 。我们可以将 ${\mathbf{h}_{T}}$ 看作整个序列的最终表示 (或特征), 并输入给分类器 ${g(\cdot)}$ 进行分类 (如图a所示)。 $${ \hat{y}=g\left(\mathbf{h}_{T}\right) }$$![[序列到类别模式.png|500]]
其中$g(·)$可以是简单的线性分类器（比如 Logistic 回归）或复杂的分类器（比如多层前馈神经网络）。

除了将最后时刻的状态作为序列表示之外，我们还可以对整个序列的所有状态进行平均，并用这个平均状态来作为整个序列的表示（如图b所示）。
$${ \hat{y}=g\left(\frac{1}{T} \sum_{t=1}^{T} \mathbf{h}_{t}\right) . }$$

## 同步的序列到序列模式
同步的序列到序列模式主要用于序列标注 (Sequence Labeling) 任务, 即每 一时刻都有输入和输出, 输入序列和输出序列的长度相同。比如词性标注 (Partof-Speech Tagging）中, 每一个单词都需要标注其对应的词性标签。 在同步的序列到序列模式 (如图所示) 中, 输入为一个长度为 ${T}$ 的序列 ${\mathbf{x}_{1: T}=\left(\mathbf{x}_{1}, \cdots, \mathbf{x}_{T}\right)}$, 输出为序列 ${y_{1: T}=\left(y_{1}, \cdots, y_{T}\right)}$ 。样本 ${\mathbf{x}}$ 按不同时刻输入 到循环神经网络中, 并得到不同时刻的隐状态 ${\mathbf{h}_{1}, \cdots, \mathbf{h}_{T}}$ 。每个时刻的隐状态 ${\mathbf{h}_{t}}$ 代表了当前时刻和历史的信息, 并输入给分类器 ${g(\cdot)}$ 得到当前时刻的标签 ${\hat{y}_{t}}$。
$${ \hat{y}_{t}=g\left(\mathbf{h}_{t}\right), \forall t \in[1, T] . }$$
![[同步的序列到序列模式.png|300]]

## 异步的序列到序列模式

异步的序列到序列模式也称为编码器-解码器（Encoder-Decoder）模型，即输入序列和输出序列不需要有严格的对应关系，也不需要保持相同的长度。比如在机器翻译中，输入为源语言的单词序列，输出为目标语言的单词序列。
![[异步的序列到序列模式.png]]
在异步的序列到序列模式中 (如图所示), 输入为一个长度为 ${T}$ 的序列 ${\mathbf{x}_{1: T}=\left(\mathbf{x}_{1}, \cdots, \mathbf{x}_{T}\right)}$, 输出为长度为 ${M}$ 的序列 ${y_{1: M}=\left(y_{1}, \cdots, y_{M}\right)}$ 。经常通过先编码后解码的方式来实现。先将样本 ${\mathrm{x}}$ 按不同时刻输入到一个循环神经网络 (编码器) 中, 并得到其编码 ${\mathbf{h}_{T}}$ 。然后在使用另一个循环神经网络 (解码器) 中, 得到输出序列 ${\hat{y}_{1: M}}$ 。为了建立输出序列之间的依赖关系, 在解码器中通常使用非线性的 #自回归模型 。
$$ 
\begin{array}{l}
\mathbf{h}_{t} =f_{1}\left(\mathbf{h}_{t-1}, \mathbf{x}_{t}\right), \forall t \in[1, T]  \\  \mathbf{h}_{T+t} =f_{2}\left(\mathbf{h}_{T+t-1}, \hat{\mathbf{y}}_{t-1}\right), \forall t \in[1, M] \\ \hat{y}_{t} =g\left(\mathbf{h}_{T+t}\right), \forall t \in[1, M] 
\end{array}
$$ 其中 ${f_{1}(\cdot), f_{2}(\cdot)}$ 分别为用作编码器和解码器的循环神经网络, ${g(\cdot)}$ 为分类器, ${\hat{\mathbf{y}}_t}$ 为预测输出 ${\hat{y}_{t}}$ 的向量表示。
