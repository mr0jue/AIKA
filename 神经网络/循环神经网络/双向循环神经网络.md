在有些任务中，一个时刻的输出不但和过去时刻的信息有关，也和后续时刻的信息有关。比如给定一个句子，其中一个词的词性由它的上下文决定，即包含左右两边的信息。因此，在这些任务中，我们可以增加一个按照时间的逆序来传递信息的网络层，来增强网络的能力。

#双向循环神经网络 （bidirectional recurrent neural network， #Bi-RNN ）由两层循环神经网络组成，它们的输入相同，只是信息传递的方向不同。

假设第 1 层按时间顺序, 第 2 层按时间逆序, 在时刻 ${t}$ 时的隐状态定义为 ${\mathbf{h}_{t}^{(1)}}$ 和 ${\mathbf{h}_{t}^{(2)}}$, 则 
$${\begin{align} \mathbf{h}_{t}^{(1)} &=f\left(U^{(1)} \mathbf{h}_{t-1}^{(1)}+W^{(1)} \mathbf{x}_{t}+\mathbf{b}^{(1)}\right) \\ \mathbf{h}_{t}^{(2)} &=f\left(U^{(2)} \mathbf{h}_{t+1}^{(2)}+W^{(2)} \mathbf{x}_{t}+\mathbf{b}^{(2)}\right) \\ \mathbf{h}_{t} &=\mathbf{h}_{t}^{(1)} \oplus \mathbf{h}_{t}^{(2)} \end{align}}$$ 其中 ${\oplus}$ 为向量拼接操作。

图给出了按时间展开的双向循环神经网络。
![[按时间展开的双向循环神经网络.png]]